# 内存空间分配
JavaScript的内存空间分为栈、堆和池（一般也会归类为栈中），其中栈存放变量（闭包中的变量并不保存在栈内存中，而是保存在堆内存中），堆存放复杂对象，池存放常量，所以也叫常量池。

## 栈
栈（Stack）又名堆栈，是一种遵循**后进先出（LIFO）**原则的有序集合。新添加或待删除的元素都保存在栈的同一端，称作栈顶，另一端就叫栈底。在栈里，新元素都靠近栈顶，旧元素都接近栈底。  
![](./images/stack.jpg)  


## 堆
堆（Heap）是一种树状结构，堆通常是一个可以被看做一颗完全二叉树的数组对象。它存取数据的方式与书架和书很类似，我们只需要知道书名就可以直接取出书，并不需要把上层的书取出来。  


## 变量的存放
* 基本类型 —— 保存在栈内存中，因为这些类型在内存中占有固定大小的空间，通过按值来访问。
* 引用类型 —— 保存在堆内存中，因为值得大小不固定，栈内存地址大小是固定的，因此不能把它们保存在栈内存中，应该保存在堆内存中，在栈内存中存放的是该对象的访问地址。当查询引用类型的变量时，先从栈中读取内存地址，然后再通过地址找到堆中的值，这种叫做按引用访问。 
![](./images/1.png)  
在计算机的数据结构中，栈比堆的运算速度快，Oject是一个复杂的结构且可以扩展，可以进行增删改查。将他们放在堆中是为了不影响栈的效率。  

## 内存空间管理
JavaScript的内存生命周期：
1. 分配所需的内存
2. 使用分配的到的内存（读、写）
3. 不需要时将其释放、归还  

JS有自动垃圾收集机制，最常用的是通过标记清除的算法来找到哪些对象是不再继续使用的。使用```a = null```仅仅只是做了一个释放引用的操作，让a原本对应的值失去引用，脱离执行环境，这个值会在下一次垃圾收集器执行操作时被找到并释放。  

在局部作用域中，当函数执行完毕后，局部变量也没有存在的必要了，因此垃圾收集器很容易做出判断并回收，但全局变量什么时候需要自动释放内存空间则很难判断，建议在开发过程中尽量避免使用全局变量。